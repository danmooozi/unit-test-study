<!-- 단순한 책 내용만 정리하는 스터디에서 벗어나 자신의 생각을 정리하고, 그걸 바탕으로 실무에 적용할 수 있는 내용을 찾는 스터디가 되었으면 좋겠습니다. -->
<!-- 참고한 글 - https://tech.kakaopay.com/post/frontend-study-journey/ -->

> [!Note]
> 1장 단위 테스트의 기초

## Summary

단위 테스트, 진입점과 종료점을 정의하고, 좋은 단위 테스트가 무엇인지 알아본다. 통합 테스트와의 차이와 테스트 주도 개발(TDD)에 대해 이해한다.

## Concept

<!-- 책을 바탕으로 발표 주제의 이론적 개념 및 필요한 배경 지식을 설명합니다. -->

### 단위 테스트 정의

> 컴퓨터 프로그래밍에서 예제 코드의 특정 모듈이 의도된 대로 정확히 작동하는지 검증하는 절차. 즉, 모든 함수와 메서드에 대한 테스트 케이스(test case)를 작성하는 절차를 말함. 이를 통해서 언제라도 코드 변경으로 인해 문제가 발생할 경우, 단시간 내에 이를 파악하고 바로잡을 수 있도록 해줌. 이상적으로, 각 테스트 케이스는 서로 분리되어야 한다. - 위키백과

- 작업 단위 :
  진입점의 호출부터 하나 이상의 종료점까지, 눈에 띄는 결과가 나타날 때까지 발생하는 모든 작업을 의미. 진입점은 어떤 것이 되어도 상관없으며 설정하기 나름.

### 진입점과 종료점

- **진입점**
  - 테스트가 작업 단위를 실행하는 지점
  - 작업 단위에는 진입점이 여러 개 있을 수 있으며, 각 진입점은 서로 다른 테스트 코드에서 사용할 수 있음.
- **종료점**
  1. **반환 값이 있는 종료점**: 작업 단위를 실행하여 진입점을 호출하고 실행 결과 값을 받아 그 값을 확인하면 됨.
  2. **상태 값을 변경하는 종료점**: 어떤 것을 호출한 후 다른 것을 호출하여 무언가를 확인하거나, 이전에 호출한 것을 다시 호출하여 모든 것이 의도대로 흘러갔는지 확인해야 함
  3. **서드 파티를 호출하는 종료점**: 서드 파티는 외부에 실행 주도권이 있는 상황이라 직접적인 코드 간섭이 힘듬. 아마? Mock object 만들어 테스트 결과를 임의로 조작하는 방법이 있음. → 복잡성을 증가시키고 유지 보수를 어렵게 만들기 때문에 피하려고 애쓰는 편.
     > 종료점마다 테스트를 만들어 분리하면 각 테스트끼리 영향을 주지 않고, 더 읽기 쉬우며, 디버깅하기도 쉽다.

### 좋은 단위 테스트란

- 테스트 작성자 의도를 이해하기 쉬워야 함
- 읽고 쓰기 쉬워야 함
- 테스트를 자동화할 수 있어야 함.
- 같은 조건에서 실행 결과는 항상 같아야 함
- 의미 있는 테스트여야 하고, 구체적인 결과를 제공하여 문제를 쉽게 파악하고 해결할 수 있어야 함.
- 누구나 쉽게 실행할 수 있어야 함.
- 실패할 경우 무엇이 잘못되었는지 쉽게 알 수 있어야 함.

**특징**

- 빠르게 실행되어야 함.
- 테스트 환경을 일관되게 유지하고, 테스트 결과가 항상 예측 가능해야 함.
- 다른 테스트와 완전히 독립적으로 실행되어야 함.
- 시스템 파일, 네트워크, 데이터베이스가 없어도 메모리 내에서 실행되어야 함.
- 가능한 한 동기적인 흐름으로 실행되어야 함. (가능하면 병렬 스레드를 사용하지 않아야 함)

**단위 테스트 체크리스트**

- 2주, 2개월, 2년 전에 만든 테스트가 여전히 잘 돌아가는가?
- 내가 2개월 전에 작성한 테스트를 팀 내 다른 동료가 실행했을 때 문제없이 결과를 받을 수 있는가?
- 내가 만든 테스트가 수분 내로 전부 실행되는가?
  - 좋은 테스트는 결국 빨라야 한다.
- 버튼 하나만 눌러서 내가 작성한 모든 테스트를 실행할 수 있는가?
  - 좋은 테스트는 수작업으로 설정하거나 실행할 필요 없이 바로 실행할 수 있어야 함.
- 기본적인 테스트를 몇 분 내로 작성할 수 있는가?
  - 좋은 테스트는 특정 객체, 함수, 의존성을 테스트하는 방법을 수립한 후에는 쉽고 빠르게 작성할 수 있어야 함.
- 다른 팀 코드에 버그가 있어도 내 테스트는 통과하는가?
- 내 테스트는 다른 실행 환경에서 실행해도 동일한 결과를 보장하는가?
- 데이터베이스나 네트워크, 배포 없이도 내 테스트는 동작하는가?
  - 위 세개, 테스트 코드가 외부 의존성에 독립적인지 묻는 질문.
- 하나의 테스트를 삭제, 이동, 변경해도 다른 테스트는 영향을 받지 않고 잘 실행되는가?

### 통합 테스트

- 앞서 언급한 좋은 단위 테스트 조건 중 하나라도 충족하지 못하는 모든 테스트를 의미함.
  > 통합 테스트는 다른 팀이 만든 모듈, 외부 API나 서비스, 네트워크, 데이터베이스, 스레드 등 실제 의존성을 완전히 제어할 수 없는 상태에서 작업 단위를 테스트하는 것이다.

**중요한 포인트 3가지**

- **가독성**: 읽기 어렵다면 유지 보수도 어렵고, 디버깅도 어렵고, 무엇이 잘못되었는지도 알기 어려움.
- **유지 보수성**: 테스트 코드를 만드느라 기존 테스트나 프로덕션 코드를 관리하기 어렵다면 뭔가 잘못하고 있을 확률이 높음
- **신뢰성**: 테스트가 실패했을 때 그 결과를 믿지 못하는 경우가 있을 수 있음. 그러면 결국에는 다시 수동으로 테스트하게 되어 엄청난 시간을 잡아먹음. 테스트가 통과했을 때도 뭔가 의심스럽다면 디버깅을 하게 되므로 마찬가지로 시간을 낭비함.

### 테스트 주도 개발(TDD)

- TDD를 잘하는 세 가지 핵심 기법
  - 좋은 테스트를 작성하는 방법을 알고, 코드보다 테스트를 먼저 작성하며, 테스트와 프로덕션 코드를 잘 설계하는 것.

## Advantages

<!-- (선택) 발표 주제를 적용했을 때 얻을 수 있는 이점이나 해결할 수 있는 문제 상황들에 대해 설명합니다. -->

## Disadvantages

<!-- (선택) 발표 주제를 적용했을 때 발생할 수 있는 side effect나 trade-off에 대해 설명합니다. -->

## Example Case

<!-- 발표 주제가 적용되어 있는 라이브러리, 실제 업무에 적용되어 있는 코드, 직접 만든 예시 코드, 자신의 느낀점 등을 첨부하여 이해를 돕습니다. -->

테스트 코드를 작성할 때 내가 고려하지 않았던 부분

- 테스트코드를 작성할 때 범용적인 검증 함수를 만들어 오류를 일관되게 처리하도록 해야함. 다른 테스트에서도 재사용할 수 있어서 여러모로 좋은 방법.
- 하나의 도메인에 새로운 기능을 추가하면서 테스트코드를 작성할 때 기존의 테스트코드가 레거시가 아니라면 추가 기능에 대한 사이드이펙트를 줄일 수 있었을 거다.
  - 하나의 테스트를 삭제, 이동, 변경해도 다른 테스트는 영향을 받지 않고 잘 실행되는가?

## Wrap-up

<!-- 발표를 마무리하며 발표 주제를 다시 요약하고 정리합니다. -->

단위 테스트란 모든 함수와 메서드에 대한 테스트 케이스(test case)를 작성하는 절차를 말함. 이를 통해서 언제라도 코드 변경으로 인해 문제가 발생할 경우, 단시간 내에 이를 파악하고 바로잡을 수 있도록 해줌.
좋은 단위 테스트와 TDD를 잘하는 방법을 알고, 적용할 수 있어야한다.
