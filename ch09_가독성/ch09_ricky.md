<!-- 단순한 책 내용만 정리하는 스터디에서 벗어나 자신의 생각을 정리하고, 그걸 바탕으로 실무에 적용할 수 있는 내용을 찾는 스터디가 되었으면 좋겠습니다. -->
<!-- 참고한 글 - https://tech.kakaopay.com/post/frontend-study-journey/ -->

> [!Note]
> 정리한 챕터나 페이지 등을 자유롭게 기록

## Summary

<!-- 한 줄 요약을 통해 발표자는 본인이 주제를 정확하게 이해했는지 점검하고, 스터디원들은 한 눈에 주제를 파악할 수 있습니다. -->

테스트 가독성을 높이는 방법들을 알아본다.

## Concept

<!-- 책을 바탕으로 발표 주제의 이론적 개념 및 필요한 배경 지식을 설명합니다. -->

> [!Note]
> 가독성 요소를 높이는 방법
>
> - 명확한 단위 테스트 이름
> - 명확한 변수 이름
> - 검증과 실행 단계 분리
> - 적절한 초기화 및 설정 해제

### 단위 테스트 이름 짓기

아래 3가지 정보가 포함되어 있어야한다.

1. 작업 단위의 진입점(=What)
2. 진입점을 테스트하는 상황(=동작)
3. 작업 단위의 종료점이 실행하는 동작(=결과)

=> 진입점 X를 // null 값으로 호출하면 // Y를 실행한다.</br>
=> 진입점 X를 // null 값으로 호출하면 // 작업단위의 종료점에서 Y가 수행되어야 한다.

#### 필수정보가 누락된 테스트

```js
// 무엇을 테스트하는가? -> 정보1 누락
test("failing rule, returns error based on rule.reason", () => {
  // ...
});

// 이것이 언제 발생해야 하는가? -> 정보2 누락
test("verifyPassword, returns error based on rule.reason", () => {
  // ...
});

// 그렇다면 어떤 일이 발생해야 하는가? -> 정보3 누락
test("verifyPassword, with a failing rule", () => {
  // ...
});
```

=> 자동화 빌드 파이브라인이 실패했을 때 표시되는 유일한 정보는 테스트 이름이다. 따라서 테스트 코드 이름을 잘 작성하는 것 만으로도 디버깅 시간과 코드를 읽는 시간을 절약할 수 있다.

> 테스트 이름을 영어로 작성 vs 한국어로 작성
>
> 위의 테스트 내용을 영어로 번역</br>
> -> **When** I call entry point X // **with** a null value // **should** do Y.
>
> 한국어로 작성하면, 중요한 분기점에 해당하는 단어나 절이 문장 뒤에 놓는다.</br>
> -> 진입점 X를 테스트**할 때** // null 값으로 호출**하면** // Y를 수행**해야 한다.**
>
> => 따라서 영어로 작성하는 것을 추천한다.(필자 생각)

### 매직넘버와 변수 이름

매직넘버란? 하드코딩된 값, 기록에 남지 않은 값, 명확하게 이해되지 않는 상수나 변수

#### 매직넘버가 작성된 케이스

```js
describe("password verifier", () => {
  test("on weekends, throws exceptions", () => {
    expect(() => verifyPassword("jhGGu78!", [], 0)).toThrowError(
      "It's the weekend!"
    );
  });
});
```

매직넘버

- jhGGu78! -> 왜 특정한 값을 사용했는가?
- [] -> 구현부를 확인해야 알 수 있는 정보
- 0 -> 구현부를 확인해야 알 수 있는 정보

#### 매직넘버를 적절히 수정한 케이스

```js
describe("verifier2 - dummy object", () => {
  test("on weekends, throws exceptions", () => {
    const SUNDAY = 0;
    const NO_RULES = [];
    expect(() => verifyPassword2("anything", NO_RULES, SUNDAY)).toThrowError(
      "It's the weekend!"
    );
  });
});
```

- anything -> 직접적인 값으로 변경하여 테스트에서 비밀번호는 중요하지 않다는 것을 알림.
- SUNDAY, NO_RULES -> 상수값을 선언하여 구현부를 확인할 필요가 사라짐.

### 검증과 실행 단계 분리

```js
expect(verifier.verify("any value")[0]).toContain("fake reason");
```

```js
const result = verifier.verify("any value"); // 실행
expect(result[0]).toContain("fake reason"); // 검증
```

=> 별것 아닌것 같아도 이 작은 차이가 디버깅을 용이하게 해준다.

> 가독성을 챙기다보면 언젠가 옆자리 동료가 테스트 코드를 잘 짜놓은 덕분에 코드를 쉽게 파악했다며 커피 한 잔 사주는 날이 올 것이다.

### 초기화 및 설정 해제

단위 테스트에서 초기화와 해제는 남용 되기 쉽다. 이를 통해 가독성이 저해될 수 있음.

목은 테스트 내에서 직접 초기화하고 모든 기댓값을 설정하는 것이 훨씬 가독성에 좋다.</br>
하지만, 유지보수성을 신경쓴다면 적절한 팩토리 함수를 통해 리팩터링을 하는 방법도 있다.

## Advantages

<!-- (선택) 발표 주제를 적용했을 때 얻을 수 있는 이점이나 해결할 수 있는 문제 상황들에 대해 설명합니다. -->

## Disadvantages

<!-- (선택) 발표 주제를 적용했을 때 발생할 수 있는 side effect나 trade-off에 대해 설명합니다. -->

## Example Case

<!-- 발표 주제가 적용되어 있는 라이브러리, 실제 업무에 적용되어 있는 코드, 직접 만든 예시 코드, 자신의 느낀점 등을 첨부하여 이해를 돕습니다. -->

9.2 매직 넘버 절에서 의미없는 "jhGGu78!" 을 "anything" 으로 수정한 것이 인상깊었다.</br>
site 테스트 코드에서 `size = 1` 나 `count = 1` 와 같이 의미없는 값을 작성하는 것이 가독성을 해친다는 생각을 하지 못했는데, 확실히 수정된 예제를 보니 확 와닿았다. 특히 처음 팀에 합류하는 인원이 DB 구조나 히스토리 파악 없이, 테스트 코드만을 봤을때 한번에 이해할 수 있겠다는 생각도 했다.

## Wrap-up

<!-- 발표를 마무리하며 발표 주제를 다시 요약하고 정리합니다. -->

- 테스트 이름을 작성할때는 작업 단위를 기준으로 3가지 요소를 필수적으로 작성해야한다.(진입점, 동작, 결과)
- 매직넘버를 제거하고 의미 있는 이름의 변수 또는 상수를 사용한다.
- 검증과 실행단계를 분리하여 가독성을 높이자.
- 초기화 함수를 적절히 사용하고, 필요시 팩토리 함수를 활용하자.
