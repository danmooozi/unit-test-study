<!-- 단순한 책 내용만 정리하는 스터디에서 벗어나 자신의 생각을 정리하고, 그걸 바탕으로 실무에 적용할 수 있는 내용을 찾는 스터디가 되었으면 좋겠습니다. -->
<!-- 참고한 글 - https://tech.kakaopay.com/post/frontend-study-journey/ -->

> [!Note]
> 12장 레거시 코드 다루기

## Summary

<!-- 한 줄 요약을 통해 발표자는 본인이 주제를 정확하게 이해했는지 점검하고, 스터디원들은 한 눈에 주제를 파악할 수 있습니다. -->

###

- 레거시 코드에서 자주 발생하는 문제 분석
- 테스트를 어디에서부터 작성할지 결정

## Concept

<!-- 책을 바탕으로 발표 주제의 이론적 개념 및 필요한 배경 지식을 설명합니다. -->

레거시 코드를 작업할 때는 다음 두 가지 문제를 해결해야 함

- 해야 할 일이 너무 많을 때는 테스트를 어디에서부터 시작하고 어느 부분에 더 집중해야 할까?
- 테스트가 없는 상태에서 기존 기능을 망가뜨리지 않은 채 어떻게 안전하게 코드를 리팩터링할 수 있을까?

### 12.1 어디에서부터 테스트를 시작해야 할까?

기존 코드가 여러 컴포넌트 안에 있다고 가정할 때, 테스트가 가정 필요하거나 시작하기 좋은 컴포넌트부터 우선순위를 정해야 함.

각 컴포넌트의 우선순위를 결정할 때 고려해야 할 몇 가지 항목이 있음

- 논리적 복잡도: 컴포넌트 내에 존재하는 논리 구조의 복잡성을 의미. (= 순환 복잡도) 다양한 도구를 활용해서 자동으로 측정할 수 있음
- 의존성 수준: 컴포넌트가 의존하는 외부 요소 수를 의미.
- 우선순위: 컴포넌트가 프로젝트 내에서 차지하는 중요도.

어떤 항목을 먼저 테스트할지는 두 가지 방식으로 결정할 수 있음

- 복잡하지만 비교적 테스트하기 쉬운 항목을 선택한다
- 복잡하고 테스트하기 어려운 항목을 선택한다

### 12.2 무엇을 선택할지 결정

### 12.2.1 쉬운 것부터 시작했을 때 장단점

- 장: 의존성이 적은 컴포넌트부터 시작하면 초기 테스트 작성이 훨씬 빠르고 수월함.
- 단: 쉬운 컴포넌트부터 시작하면 가장 어려운 컴포넌트를 테스트할 때까지 시간이 점점 더 많이 소요됨.

팀이 단위 테스트에 익숙하지 않다면 간단한 컴포넌트부터 시작하는 것이 좋음. 시간이 지나면서 팀원 개개인이 점차 역량을 키워 더 복잡한 컴포넌트와 의존성도 다룰 수 있게 될 것.

### 12.2.2 어려운 것부터 시작했을 때 장단점

- 초기에는 테스트 작성 시간이 많이 걸리지만, 의존성이 리팩터링되면서 시간이 점차 줄어듬
- 구현이 더 복잡하기 때문에 팀원 개개인이 단위 테스트에 경험이 풍부할 때만 가능한 선택지임.

## 12.3 리팩터링 전에 통합 테스트 작성

- 코드를 리팩터링해서 단위 테스트를 작성한다면 리팩터링을 하더라도 기존 기능이 제대로 동작한다는 것을 보장할 수 있도록 운영 시스템에 대한 통합 테스트를 미리 작성하는 것이 좋음.
- 과정
  - 원래 시스템이 정상 작동하는지 확인하기 위해 통합 테스트(목이나 스텁 없이)를 추가한다.
  - 시스템에 추가하려는 기능에 대해 실패하는 테스트를 작성하거나 리팩터링을 시작한다.
  - 시스템을 작은 단위로 리팩터링하고 통합 테스트를 자주 실행해서 무언가 잘못된 부분은 없는지 확인한다.
- 테스트를 계속 추가하면서 시스템을 리팩터링하고 더 많은 단위 테스트를 작성하다 보면, 시스템이 점점 더 유지 보수하기 쉽고 테스트가 용이한 구조로 바뀜. 시간이 오래 걸리기는 하지만 충분히 그럴 만한 가치가 있음.

### 12.3.1 마이클 패더스 도서 참고

- 레거시 코드 활용 전략; 레거시 코드에서 겪게 될 다양한 문제를 다룬 참고소임.

### 12.3.2 CodeScene을 사용하여 프로덕션 코드 분석

CodeScene 도구는 레거시 코드에서 기술적 부채와 숨겨진 문제를 찾아내는데 유용함.

## Advantages

<!-- (선택) 발표 주제를 적용했을 때 얻을 수 있는 이점이나 해결할 수 있는 문제 상황들에 대해 설명합니다. -->

## Disadvantages

<!-- (선택) 발표 주제를 적용했을 때 발생할 수 있는 side effect나 trade-off에 대해 설명합니다. -->

## Example Case

<!-- 발표 주제가 적용되어 있는 라이브러리, 실제 업무에 적용되어 있는 코드, 직접 만든 예시 코드, 자신의 느낀점 등을 첨부하여 이해를 돕습니다. -->

여기서도 마찬가지로 통합 테스트의 중요성을 말하고 있음. 특히 대규모 리팩터링을 시작하기 전에 리팩터링 후에도 큰 코드 변화 없이 유지할 수 있는 통합 테스트를 작성하면 좋다고 하는데, ide-site 프/백 분리가 이 경우가 아닐까 싶다.

## Wrap-up

<!-- 발표를 마무리하며 발표 주제를 다시 요약하고 정리합니다. -->
