<!-- 단순한 책 내용만 정리하는 스터디에서 벗어나 자신의 생각을 정리하고, 그걸 바탕으로 실무에 적용할 수 있는 내용을 찾는 스터디가 되었으면 좋겠습니다. -->
<!-- 참고한 글 - https://tech.kakaopay.com/post/frontend-study-journey/ -->

> [!Note]
> 정리한 챕터나 페이지 등을 자유롭게 기록

## Summary

<!-- 한 줄 요약을 통해 발표자는 본인이 주제를 정확하게 이해했는지 점검하고, 스터디원들은 한 눈에 주제를 파악할 수 있습니다. -->

좋은 단위 테스트의 첫번째 기준인 **'신뢰성'** 을 위해, 버그가 있는지 없는지를 정확하게 판단할 수 있는 테스트를 작성하는 방법과 올바른 테스트 실패와 잘못된 테스트 실패의 차이점을 알 수 있다.

## Concept

<!-- 책을 바탕으로 발표 주제의 이론적 개념 및 필요한 배경 지식을 설명합니다. -->

### 테스트를 신뢰할 수 있는지 판단하는 방법

#### 신뢰하지 않는 경우

- 테스트는 실패했지만 신경 쓰지 않는 경우(=거짓 양성)
- 1)테스트가 가끔 통과하거나 2)테스트가 현재 작업과 관련 없다고 생각하거나 3)테스트에 버그가 있다고 느낄 때(테스트 결과를 무시해도 괜찮다고 생각하는 경우)
- 테스트가 통과했지만 의심스러운 경우(=거짓 음성)
- "만약에 대비하여" 직접 디버깅하거나 프로그램을 테스트할 필요를 느끼는 경우

#### 신뢰하는 경우

- 테스트가 실패했을 때, 코드의 무언가가 잘못되었을까봐 걱정하는 경우(쉽게 넘어가지 않음)
- 테스트가 통과한 경우

### 신뢰할 수 없는 테스트 케이스

#### 테스트가 실패하는 이유

1. 프로덕션 코드에서 실제 버그가 발견된 경우
   => 버그로 인해 테스트 코드를 수정하면 되서 수정하기 쉬움
2. 테스트가 거짓 실패(양성)를 일으키는 경우

- 종료점의 예상 결과를 잘못 설정
- 테스트 대상 시스템(SUT)을 잘못 사용
- 테스트 환경을 잘못 설정

  > **테스트 코드 디버깅하는법**
  >
  > - 잘못된 항목 or 종료점 검증
  > - 잘못된 값을 진입점에 전달
  > - 진입점을 잘못 호출

3. 기능 변경으로 테스트가 최신 상태가 아닌 경우

- 테스트를 새로운 기능에 맞게 수정
- 테스트를 새로 만들고 기존 테스트를 제거

4. 테스트가 다른 테스트와 충돌하는 경우

- Product Owner 에게 물어본다.(맞는 말인데 뭔가 웃김..)

5. 테스트가 불안정한 경우

- (테스트 수준이 올라갈수록 실제 의존성을 더 많이 사용하므로 변동요소가 많아진다.)
  - 테스트 코드가 외부 시스템을 변경했으면 변경한 내용을 롤백한다.
  - 다른 테스트가 외부 시스템의 상태를 변경하지 않도록 한다.
  - 외부 시스템과 의존성을 제어할 수 있어야 한다.
- 문제를 정의하고 별도의 폴더나 카테고리에 따로 모아 실행될 수 있도록 한다.
  - 이후 수정/리팩토링/삭제 작업을 진행한다.

### 테스트 신뢰성을 높이는 방법

#### 단위 테스트에서 불필요한 로직 제거

지양해야될 문법

- switch, if, else 문
- foreach, for, while
- 문자열 연결(+ 기호)
- try-catch 블록

> [!Note]
> 복잡한 테스트가 원래의 간단한 테스트를 대체하면 오히려 프로덕션 코드에서 버그를 찾기가 더 어렵다. 이는 복잡한 테스트가 다양한 상황을 다루다 보니 특정 문제를 정확히 파악하기 어려워 실제로 버그를 놓칠 가능성이 높기 때문이다. **따라서 복잡한 테스트를 만들어야 한다면 기존의 간단한 테스트를 대체하지 말고 새로운 테스트로 추가해야 한다.**

#### 코드리뷰가 필요한 테스트

'잘못된 신뢰'란? -> 신뢰하지 말아야 할 테스트를 신뢰하지만, 그 사실을 아직 모르는 상태

테스트가 통과하더라도 믿지 못하는 케이스

- 검증 부분이 없는 경우
  - 함수 호출 내 검증 로직이 숨어 있을 수 있음
  - 단순히 코드를 실행하여 예외가 발생하지 않는지 확인하는 테스트
    - `expect(() => someFunction()).not.thThrow(error)` -> 지양해야할 기능
- 테스트를 이해할 수 없는 경우
  - 이름이 적절하지 않음
  - 코드가 너무 길거나 복잡함
  - 변수 이름이 헷갈림
  - 숨어 있는 로직, 이해하기 어려운 가정을 포함
  - 결과가 불분명함(실패도 아니고 통과도 아닌 경우)
  - 충분한 정보를 제공하지 않음
- 단위 테스트가 불안정한 통합 테스트와 섞여 있는 경우
  - => 두 테스트가 섞이지 않도록 안정적인 테스트 영역을 만들어야 함
- 테스트가 여러 가지를 한꺼번에 검증하는 경우
  - ex) 두 가지 종료점을 가지는 함수
- 테스트가 자주 변경되는 경우
  - 예상 기댓값도 함께 계산해야 함

## Advantages

<!-- (선택) 발표 주제를 적용했을 때 얻을 수 있는 이점이나 해결할 수 있는 문제 상황들에 대해 설명합니다. -->

## Disadvantages

<!-- (선택) 발표 주제를 적용했을 때 발생할 수 있는 side effect나 trade-off에 대해 설명합니다. -->

## Example Case

<!-- 발표 주제가 적용되어 있는 라이브러리, 실제 업무에 적용되어 있는 코드, 직접 만든 예시 코드, 자신의 느낀점 등을 첨부하여 이해를 돕습니다. -->

- 2부까지는 테스트 코드를 작성하는데 필요한 기술을 배웠다면, 7장부터는 효과적인 단위 테스트에 대해 집중하여 알게되었다.
- 그래서 이전까지는 테스트가 성공만한다면 일단 웃고 넘어가는 경우가 많았는데, 성공한 테스크 코드여도 신뢰성을 생각하며 코드를 작성해야겠다는 생각이들었다.

## Wrap-up

<!-- 발표를 마무리하며 발표 주제를 다시 요약하고 정리합니다. -->
